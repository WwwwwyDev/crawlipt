---
description: æœ¬ç« ä»‹ç»è„šæœ¬çš„åŸºæœ¬ä½¿ç”¨ã€‚è„šæœ¬ä½¿ç”¨jsonæ ¼å¼å®šä¹‰ï¼Œåœ¨å„ç§è¯­è¨€ä¸­ï¼Œä½ éƒ½å¯ä»¥å¾ˆæ–¹ä¾¿å°†å®ƒååºåˆ—åŒ–ã€‚
---

# ğŸ» Script

### è½¬æ¢æ–¹å¼

```python
import crawlipt as cpt

# åœ¨ç¼–å†™é˜¶æ®µå¯ä»¥ä½¿ç”¨pythonå†…ç½®å­—å…¸ç±»å‹è¿›è¡Œç¼–å†™
script = { 
    "method": "redirect",
    "url": "https://www.baidu.com/",
    "next": {
        "method": "input",  # æ–¹æ³•å
        "xpath": "//*[@id=\"kw\"]", # æ–¹æ³•å¯¹åº”å‚æ•°
        "text": "ç™¾åº¦è´´å§", # æ–¹æ³•å¯¹åº”å‚æ•°
        "next": { # ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„è„šæœ¬
            "method": "click",
            "xpath": "//*[@id=\"su\"]"
        }
    }
}
# è½¬æ¢ä¸ºäº†ä¸€ä¸ªjsonå­—ç¬¦ä¸²ï¼Œå¯ä»¥å°†å®ƒå­˜å‚¨åœ¨ç‰©ç†ä»‹è´¨ä¸­
script_json = cpt.Script.generate_json(script) 
```

### æ‰§è¡Œè„šæœ¬

è„šæœ¬å¯ä»¥æ˜ å°„æ‰€æœ‰çš„actionæ–¹æ³•

```python
webdriver = getDriver()
# ä¼ å…¥ä¸€ä¸ªé¢„å…ˆç¼–å†™å¥½çš„è„šæœ¬ï¼Œæ”¯æŒjsonå­—ç¬¦ä¸²ï¼Œpythonå­—å…¸ã€åˆ—è¡¨ç±»å‹
loader = cpt.Script(script, interval=0.1)
# ä¼ å…¥ä½ é…ç½®å¥½çš„seleniumçš„webdriverå¯¹è±¡è¿›è¡Œæ‰§è¡Œ
loader.process(webdriver) 
# loader(webdriver) 
# ä½ éœ€è¦å…³é—­ä½ çš„webdriveråœ¨æ‰§è¡Œå
webdriver.quit()
```

### è„šæœ¬æ‰§è¡Œå™¨å‚æ•°ä»‹ç»

| å‚æ•°å                     | ç±»å‹                         | ä»‹ç»                                                                                                       |
| ----------------------- | -------------------------- | -------------------------------------------------------------------------------------------------------- |
| script                  | dict \| str \| list        | é¢„å…ˆç¼–å†™å¥½çš„è„šæœ¬                                                                                                 |
| global\_script          | dict \| str \| list = None | å…¨å±€æ‰§è¡Œè„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬å°†åœ¨æ¯æ¬¡æ‰§è¡Œä»»æ„ä¸€ä¸ªactionæ–¹æ³•å‰è¿›è¡Œæ‰§è¡Œã€‚ä¾‹å¦‚ï¼šæœ‰çš„ç½‘ç«™ä¼šéšæœºå¼¹å‡ºå¹¿å‘Šï¼Œå½±å“ä¸‹é¢è„šæœ¬çš„æ‰§è¡Œï¼Œå®šä¹‰è¯¥è„šæœ¬å¯ä»¥åœ¨æ‰§è¡Œactionæ–¹æ³•å‰åˆ¤æ–­æ˜¯å¦æœ‰å¹¿å‘Šï¼Œå¦‚æœæœ‰çš„è¯å»è¿›è¡Œä¸€ç³»åˆ—æ“ä½œå…³é—­å¹¿å‘Š |
| interval                | float = 0.5                | æ¯ä¸¤æ¬¡actionæ–¹æ³•æ‰§è¡Œçš„é—´éš”                                                                                         |
| wait                    | float = 10                 | æœ€é•¿ç­‰å¾…xpathå¯¹åº”å…ƒç´ å‡ºç°çš„æ—¶é—´                                                                                       |
| is\_need\_syntax\_check | bool = True                | æ˜¯å¦éœ€è¦æ‰§è¡Œå‰ä¸¥æ ¼çš„è„šæœ¬è¯­æ³•æ£€æŸ¥ï¼Œå¦‚æœå…³é—­ä¼šå¢åŠ æ‰§è¡Œæ—¶çš„é”™è¯¯æ¦‚ç‡                                                                         |

### é€šè¿‡åˆ—è¡¨stepæ–¹å¼ç¼–å†™è„šæœ¬

&#x20;é€šè¿‡å­—å…¸ç±»å‹è¿›è¡Œç¼–å†™è„šæœ¬ï¼Œåœ¨actionå¤šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´åµŒå¥—å­—å…¸è¿‡æ·±ï¼Œç»´æŠ¤å›°éš¾ã€‚ä½¿ç”¨åˆ—è¡¨æ–¹å¼ç¼–å†™è„šæœ¬å¯ä»¥å°†åµŒå¥—æµç¨‹å˜ä¸ºä¸²è¡Œæµç¨‹ã€‚

```python
step = [{
            "method": "redirect",
            "url": "https://fanyi.baidu.com/mtpe-individual/multimodal#/",
        }, {
            "method": "input",
            "xpath": "//*[@id=\"editor-text\"]/div[1]/div[1]/div/div/div/div",
            "text": "ä½ å¥½ï¼Œä¸–ç•Œ",
        }, {
            "method": "getInnerText",
            "xpath": "//*[@id=\"trans-selection\"]/div/span",
        }]

# ä½ å¯ä»¥ä½¿ç”¨generateï¼Œå°†åˆ—è¡¨è„šæœ¬å˜ä¸ºå­—å…¸è„šæœ¬
script_dict = cpt.Script.generate(step)
# ä½ å¯ä»¥ä½¿ç”¨generate_jsonï¼Œå°†åˆ—è¡¨è„šæœ¬ç›´æ¥å˜ä¸ºjsonå­—ç¬¦ä¸²
script_json = cpt.Script.generate_json(step)
# æ‰§è¡Œå™¨ä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œåˆ—è¡¨è„šæœ¬
loader = cpt.Script(step, interval=0.1)
loader.process(webdriver) 
```
